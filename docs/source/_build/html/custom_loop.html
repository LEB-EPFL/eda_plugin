<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Custom Loop Compilation &mdash; event-driven-acquisition 0.2 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Creating Custom components" href="custom_components.html" />
    <link rel="prev" title="Usage" href="usage.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> event-driven-acquisition
          </a>
              <div class="version">
                0.2.5
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Custom Loop Compilation</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_components.html">Creating Custom components</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">api</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">event-driven-acquisition</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Custom Loop Compilation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/custom_loop.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="custom-loop-compilation">
<h1>Custom Loop Compilation<a class="headerlink" href="#custom-loop-compilation" title="Permalink to this headline">Â¶</a></h1>
<p>Every full EDA loop consists of at least three components. An actuator, an analyser and an
interpreter. To run your own EDA loop, you also have to supply an EventBus for communication
between the different components and you have to construct a QApplication for the Qt GUI
to run in.</p>
<p>This is the basic example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">import</span> <span class="nn">eda_plugin.utility.settings</span>
<span class="kn">from</span> <span class="nn">eda_plugin.actuators.micro_manager</span> <span class="kn">import</span> <span class="n">TimerMMAcquisition</span>
<span class="kn">from</span> <span class="nn">eda_plugin.interpreters.frame_rate</span> <span class="kn">import</span> <span class="n">BinaryFrameRateInterpreter</span>
<span class="kn">from</span> <span class="nn">eda_plugin.utility.eda_gui</span> <span class="kn">import</span> <span class="n">EDAMainGUI</span>
<span class="kn">from</span> <span class="nn">eda_plugin.utility.event_bus</span> <span class="kn">import</span> <span class="n">EventBus</span>
<span class="kn">from</span> <span class="nn">PyQt5</span> <span class="kn">import</span> <span class="n">QtWidgets</span>


<span class="k">def</span> <span class="nf">basic</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;EDA loop that can be used to test without a microscope and without CUDA installation.&quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">eda_plugin.actuators.micro_manager</span> <span class="kn">import</span> <span class="p">(</span><span class="n">MMActuator</span><span class="p">,</span>
                                                    <span class="n">TimerMMAcquisition</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">eda_plugin.analysers.image</span> <span class="kn">import</span> <span class="n">ImageAnalyser</span>

    <span class="n">eda_plugin</span><span class="o">.</span><span class="n">utility</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">setup_logging</span><span class="p">()</span>

    <span class="c1"># Construct the QApplication environment, that the GUIs and event loop runs in.</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>

    <span class="c1"># Start an additional zmq server that works together with the PythonEventServer Plugin</span>
    <span class="c1"># for both communication between the EDA components and Micro-Manager.</span>
    <span class="n">event_bus</span> <span class="o">=</span> <span class="n">EventBus</span><span class="p">()</span>

    <span class="c1"># Call the main components of the EDA loop (TimerMMAcquisition is also the default)</span>
    <span class="n">actuator</span> <span class="o">=</span> <span class="n">MMActuator</span><span class="p">(</span><span class="n">event_bus</span><span class="p">,</span> <span class="n">TimerMMAcquisition</span><span class="p">)</span>
    <span class="n">analyser</span> <span class="o">=</span> <span class="n">ImageAnalyser</span><span class="p">(</span><span class="n">event_bus</span><span class="p">)</span>
    <span class="n">interpreter</span> <span class="o">=</span> <span class="n">BinaryFrameRateInterpreter</span><span class="p">(</span><span class="n">event_bus</span><span class="p">)</span>

    <span class="c1"># Start the main GUI showing the EDA plot and the controls for the specific components</span>
    <span class="n">gui</span> <span class="o">=</span> <span class="n">EDAMainGUI</span><span class="p">(</span><span class="n">event_bus</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">gui</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">actuator</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">interpreter</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Start the event loop</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">exec_</span><span class="p">())</span>
</pre></div>
</div>
<p>The normal use case for custom situation will be to replace one of the main components, <cite>actuator</cite>,
<cite>analyser</cite> or <cite>interpreter</cite>. If implemented correctly, compatible components should be exchangable
individually.</p>
<p>For available components in the original package see the <a class="reference internal" href="api.html"><span class="doc">api</span></a>.</p>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="usage.html" class="btn btn-neutral float-left" title="Usage" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="custom_components.html" class="btn btn-neutral float-right" title="Creating Custom components" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Willi L. Stepp.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>